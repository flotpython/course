<div class='clipboard'><style>
.clipboard {
    font-size: 11px;
}
</style>

<h3 style="border: 1px solid #66b; border-radius: 5px; padding: 10px; background-color: #eee;">
<b><i>bloc-note pour copier/coller le code de la vidéo</i></b>
</h3>
<hr />
<!-- Version Python 3.10 -->
<h3 style="border: 1px solid #66b; border-radius: 5px; padding: 10px; background-color: #eee;">
<b><i>La vidéo a été tournée avec la 3.6, le cours a été mis à jour pour 3.10.
Il est préférable d'utiliser les fonctions asyncio de haut niveau, telles qu'asyncio.run().
Le référencement de l'objet boucle ou l'appel de ses méthodes s'adresse principalement aux auteurs de code,
de bibliothèques et de frameworks de niveau inférieur, qui ont besoin d'un contrôle plus fin du comportement de la boucle d'événement.
</i></b>
</h3>
<hr />
<blockquote>
<p>Prendre l’éditeur IDLE et faire nouveau fichier</p>
</blockquote>
<pre><code>import asyncio

async def morceaux(message):
    # On appelle le code synchrone normalement
    print(message, &quot;début&quot;)
    # avec await on rend la main
    await asyncio.sleep(0.5)
    
    print(message, &quot;milieu&quot;)
    await asyncio.sleep(1)
    
    print(message, &quot;fin&quot;)
    return f'{message} par morceaux'

<!-- add coroutines -->
async def main():
    L = await asyncio.gather(
        morceaux("run 1"),
        morceaux("run 2"),
    )
    print(L)

</code></pre>
<blockquote>
<p>Faire Save As &quot;w8s2 Vidéo.py&quot; puis F5</p>
</blockquote>
<pre><code>morceaux

morceaux(&quot;run&quot;)

asyncio.run(morceaux(&quot;run&quot;))

asyncio.run(main())
</code></pre>
<blockquote>
<p>Reprendre sous IDLE le fichier python et ajouter</p>
</blockquote>
<pre><code>import time


# Exemple de ce qu'il ne faut pas faire
async def famine(message):
    
    print(message, &quot;début&quot;)
    # avec await on rend la main
    await asyncio.sleep(0.5)
    
    print(message, &quot;milieu&quot;)
    # on garde la main au lieu de la rendre
    time.sleep(1)
    
    print(message, &quot;fin&quot;)
    return f'{message} par famine'

async def main():
    L = await asyncio.gather(
        famine("run 1"),
        famine("run 2"),
    )
    print(L)
</code></pre>
<blockquote>
<p>Faire Ctl-s puis F5</p>
</blockquote>
<pre><code>
asyncio.run(main())
</code></pre>
</div>